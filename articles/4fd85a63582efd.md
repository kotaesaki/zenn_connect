---
title: "react-route-dom v6ã‚’ä½¿ã£ã¦ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ†ã‚¹ãƒˆã—ãŸã‚‰ã²ã£ã‹ã‹ã£ãŸ[createReactRouterä½¿ã£ã¦ã¿ã‚ˆã†]"
emoji: "ğŸ¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["react", "react-route-dom"]
published: false
---
# ã¯ã˜ã‚ã«
```ts
// App.tsx
function App() {
  return (
    <Routes>
      <Route path="hoge" element={<Hoge />} />
      <Route path="piyo" element={<Piyo />} />
    </Routes>
  );
}
export default App;
// Hoge.tsx
export const Hoge = () => {
  let isPiyo: boolean = false;
  if(isPiyo) return <Navigate to="/piyo" />;
  return <>isHoge</>
}
```
ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã§```isPiyo```ãŒtrueã®å ´åˆã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã‹ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¨ãã«åœ°å‘³ã«å¼•ã£ã‹ã‹ã£ãŸã£ã¦ã„ã†ãŠè©±ã§ã™ã€‚
# ç’°å¢ƒ
```
"react": "^18.1.0"
"react-router-dom": "6.4.4"
"jest": "29.3.1"
"jest-environment-jsdom": "29.3.1"
```
# çµè«–
createMemoryRouterä½¿ã£ãŸã‚‰ã§ããŸï¼
https://reactrouter.com/en/main/routers/create-memory-router
```ts
const router = createMemoryRouter(
  [
    {
      path: "/hoge",
      element: <Hoge />,
    },
  ],
  { initialEntries: ["/hoge"] }
);
describe("Hoge.tsx", () => {
  test("isPiyoãŒtrueã®å ´åˆã€Piyo.tsxã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹", async() => {
    render(<RouterProvider router={router} />);
    await waitFor(() => {
      expect(router.state.location.pathname).toEqual("/piyo");
    });
  });
})
```
# è§£èª¬
https://reactrouter.com/en/main/routers/create-memory-router
> ãƒ–ãƒ©ã‚¦ã‚¶ã®å±¥æ­´ã‚’ä½¿ç”¨ã™ã‚‹ä»£ã‚ã‚Šã«ã€ãƒ¡ãƒ¢ãƒªãƒ«ãƒ¼ã‚¿ãƒ¼ã¯ãƒ¡ãƒ¢ãƒªå†…ã®å±¥æ­´ã‚¹ã‚¿ãƒƒã‚¯ã‚’ç‹¬è‡ªã«ç®¡ç†ã—ã¾ã™ã€‚ä¸»ã«ãƒ†ã‚¹ãƒˆã‚„Storybookã®ã‚ˆã†ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–‹ç™ºãƒ„ãƒ¼ãƒ«ã«æœ‰ç”¨ã§ã™ãŒã€ãƒ–ãƒ©ã‚¦ã‚¶ä»¥å¤–ã®ç’°å¢ƒã§React Routerã‚’å‹•ä½œã•ã›ã‚‹å ´åˆã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã®å‡¦ç†ã‚’è¡Œã†å ´åˆã€æœ¬æ¥ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã®å±¥æ­´ãŒä¿æŒã•ã‚Œã¾ã™ã€‚
Jestãªã©ã®ãƒ†ã‚¹ãƒˆç’°å¢ƒã§Nodeã‚„jsdomç’°å¢ƒã§è¡Œã†ã“ã¨ã«ãªã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã€ãã®å ´åˆãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å±¥æ­´ã‚’æ‰‹å‹•ã§ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹æ©Ÿèƒ½ã®ã‚ˆã†ã§ã™ã€‚
https://reactrouter.com/en/main/routers/create-browser-router#routes
```ts
const router = createMemoryRouter(
  [
    {
      path: "/hoge",
      element: <Hoge />,
    },
  ],
  { initialEntries: ["/hoge"] }
);
export declare function createMemoryRouter(routes: {
    path?: string, // "/"
    element?: string,  //  <Root />
    loader?: LoaderFunction // rootLoader
    children?: [
      {
        path?: string,  // "events/:id",
        element?: string, // <Event />,
        loader?: LoaderFunction // eventLoader
      },
    ],
  }[],
  opts?: {
    basename?: string;
    hydrationData?: HydrationState;
    initialEntries?: InitialEntry[];
    initialIndex?: number;
}): RemixRouter;
```
ç¬¬ä¸€å¼•æ•°routesã«é…åˆ—ã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æƒ…å ±ã‚’æ¸¡ã—ã¾ã™ã€‚routesã‚’æŒ‡å®šã—ã¦ã‚ã’ã‚‹ã“ã¨ã§```RouterPrivider```ã¯pathã¨elementã‚’ç´ä»˜ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
https://reactrouter.com/en/main/routers/router-provider#routerprovider
ç¬¬äºŒå¼•æ•°ã¯optionalãªã®ã§é©å®œè¿½åŠ ã§OKã§ã™ã€‚
```initialEntries```ã¯æœ€åˆã®çŠ¶æ…‹ã§å±¥æ­´ã«æ®‹ã—ãŸã„ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’æŒ‡å®šã—ã¾ã™ã€‚ä»Šå›ã¯```/hoge```ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸæ™‚ã®æŒ™å‹•ã‚’ç¢ºã‹ã‚ãŸã„ã®ã§ã€```initialEntries```ã«ã¯```/hoge```ã‚’æŒ‡å®šã—ã¾ã™ã€‚
```initialEntries```ã¯è¤‡æ•°æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¦ã€ãã®å ´åˆã¯é…åˆ—ã®æœ€å¾ŒãŒã‚¹ã‚¿ãƒ¼ãƒˆä½ç½®ã«ãªã‚Šã¾ã™ã€‚
```ts
createMemoryRouter(routes, {
  initialEntries: ["/hoge", "/"], // ã“ã®å ´åˆã¯"/"ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹
});
```
ä»Šå›ã¯ä½¿ã£ã¦ãªã„ã§ã™ãŒã€```initialIndex```ã§ã‚¹ã‚¿ãƒ¼ãƒˆä½ç½®ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```ts
createMemoryRouter(routes, {
  initialEntries: ["/hoge", "/"], // ã“ã®å ´åˆã¯"/hoge"ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹
  initialIndex: 0
});
```
# ãŠã‚ã‚Šã«ğŸ¥
å‚è€ƒã«ãªã£ãŸã‚‰å¹¸ã„ã§ã™ï¼